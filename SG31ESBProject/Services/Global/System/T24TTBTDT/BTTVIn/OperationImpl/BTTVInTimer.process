<?xml version="1.0" encoding="UTF-8"?>
<pd:ProcessDefinition xmlns:ns2="www.tibco.com/plugin/Sleep" xmlns:pd="http://xmlns.tibco.com/bw/process/2003" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns1="http://www.tibco.com/pe/EngineTypes" xmlns:ns="http://www.tibco.com/namespaces/tnt/plugins/file/v2" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tib="http://www.tibco.com/bw/xslt/custom-functions" xmlns:pfx3="www.tibco.com/plugin/Timer" xmlns:pfx2="http://www.tibco.com/namespaces/tnt/plugins/file" xmlns:pfx="http://www.tibco.com/pe/DeployedVarsType">
    <pd:name>Services/Global/System/T24TTBTDT/BTTVIn/OperationImpl/BTTVInTimer.process</pd:name>
    <pd:startName>Timer</pd:startName>
    <pd:startX>0</pd:startX>
    <pd:startY>0</pd:startY>
    <pd:returnBindings/>
    <pd:starter name="Timer">
        <pd:type>com.tibco.plugin.timer.TimerEventSource</pd:type>
        <pd:resourceType>ae.activities.timer</pd:resourceType>
        <pd:x>91</pd:x>
        <pd:y>35</pd:y>
        <config>
            <StartTime>1447203600000</StartTime>
            <Frequency>false</Frequency>
            <TimeInterval>%%ServiceGlobalVar/BTTVIn/Timeinterval_ms%%</TimeInterval>
            <FrequencyIndex>Millisecond</FrequencyIndex>
        </config>
        <pd:inputBindings/>
    </pd:starter>
    <pd:endName>End</pd:endName>
    <pd:endX>743</pd:endX>
    <pd:endY>35</pd:endY>
    <pd:errorSchemas/>
    <pd:processVariables>
        <CurrentProcess>
            <xsd:element name="CurrentProcess" type="xsd:int"/>
        </CurrentProcess>
    </pd:processVariables>
    <pd:targetNamespace>http://xmlns.example.com/1447150519765</pd:targetNamespace>
    <pd:activity name="InitProcess">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>908</pd:x>
        <pd:y>506</pd:y>
        <config>
            <variableName>CurrentProcess</variableName>
        </config>
        <pd:inputBindings>
            <CurrentProcess>
                <xsl:value-of select="0"/>
            </CurrentProcess>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="QueryBTTVGW">
        <pd:type>com.tibco.plugin.jdbc.JDBCQueryActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCQueryActivity</pd:resourceType>
        <pd:x>743</pd:x>
        <pd:y>321</pd:y>
        <config>
            <timeout>10</timeout>
            <commit>false</commit>
            <maxRows>100</maxRows>
            <emptyStrAsNil>false</emptyStrAsNil>
            <statement>	SELECT * FROM(
        select tbl.*, c.* from BTDT_DIENDI tbl left join MA_CHINHANH_T24 c
        on tbl.bank_sort_code = c.MA_DONVI
        where tbl.status = ?
        order by tbl.SOGIAODICH) 
    WHERE rownum &lt;= ?</statement>
            <jdbcSharedConfig>/SharedResource/Connection/Jdbc/TTBTCT DB.sharedjdbc</jdbcSharedConfig>
            <wizardData/>
            <oraObjects/>
            <oraTables/>
            <QueryOutputCachedSchemaColumns>TRANSACTION_TYPE</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>ID</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>SOGIAODICH</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>DEBIT_ACCOUNT</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>CREDIT_ACCOUNT</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>AMOUNT</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>2</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>number</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>CURRENCY</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>VALUE_DATE</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>DR_OR_CR</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>SENDING_BANK_CODE</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>BANK_SORT_CODE</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>ORDERING_CUSTOMER</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>ORDERING_CUSTOMER1</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>IN_SEND_BANK</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>IN_BENEFICIARY</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>IN_BENEFICIARY_ACCOUNT_NO</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>IN_RECEIVING_BANK</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>PAYMNET_DETAILS</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>STATUS</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>-5</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>number</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>ERR_MSG</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>L_R_INDIRECT_NAME</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>L_ORD_CUST_ADD</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>L_ORD_CUST_ACCT</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>L_BEN_CUST_ADD</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>MA_DONVI_T24</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>MA_DONVI</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>TENDONVI</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>MNEMONIC</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar2</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>STT_NGAY</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>2</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>number</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <Prepared_Param_DataType>
                <parameter>
                    <parameterName>Status</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
                <parameter>
                    <parameterName>Rowcount</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
            </Prepared_Param_DataType>
        </config>
        <pd:inputBindings>
            <jdbcQueryActivityInput>
                <Status>
                    <xsl:value-of select="$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/BTTVDB_Status_New"/>
                </Status>
                <Rowcount>
                    <xsl:value-of select="$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/RowCount"/>
                </Rowcount>
            </jdbcQueryActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:group name="Group">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>1011</pd:x>
        <pd:y>127</pd:y>
        <pd:width>455</pd:width>
        <pd:height>200</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>repeat</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:indexSlot>index</pd:indexSlot>
            <pd:activityOutputName/>
            <pd:repeatCondition>$CurrentProcess/CurrentProcess=$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessNumber</pd:repeatCondition>
            <pd:accumulateOutput>false</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>CallT24WSCitadIn</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>IncreProcessNumber</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>CallT24WSCitadIn</pd:from>
            <pd:to>IncreProcessNumber</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="IncreProcessNumber">
            <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
            <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
            <pd:x>1334</pd:x>
            <pd:y>233</pd:y>
            <config>
                <variableName>CurrentProcess</variableName>
            </config>
            <pd:inputBindings>
                <CurrentProcess>
                    <xsl:value-of select="$CurrentProcess/CurrentProcess+1"/>
                </CurrentProcess>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="CallT24WSCitadIn">
            <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
            <pd:resourceType>ae.process.subprocess</pd:resourceType>
            <pd:x>1131</pd:x>
            <pd:y>235</pd:y>
            <config>
                <spawn>true</spawn>
                <processName>/Services/Global/System/T24TTBTDT/BTTVIn/OperationImpl/CallT24WSBTTVIn.process</processName>
            </config>
            <pd:inputBindings>
                <DataBTTVInput>
                    <ProcessID>
                        <xsl:value-of select="$index"/>
                    </ProcessID>
                    <RowStart>
                        <xsl:value-of select="floor(($index - 1)*(count($QueryBTTVGW/resultSet/Record) div $_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessNumber ))"/>
                    </RowStart>
                    <RowEnd>
                        <xsl:value-of select="floor($index *(count($QueryBTTVGW/resultSet/Record) div $_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessNumber))"/>
                    </RowEnd>
                    <Result>
                        <xsl:copy-of select="$QueryBTTVGW/resultSet"/>
                    </Result>
                </DataBTTVInput>
            </pd:inputBindings>
        </pd:activity>
    </pd:group>
    <pd:activity name="Null">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>337</pd:x>
        <pd:y>458</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Remove File">
        <pd:type>com.tibco.plugin.file.FileRemoveActivity</pd:type>
        <pd:resourceType>ae.activities.FileRemoveActivity</pd:resourceType>
        <pd:x>88</pd:x>
        <pd:y>544</pd:y>
        <config/>
        <pd:inputBindings>
            <pfx2:RemoveActivityInputClass>
                <fileName>
                    <xsl:value-of select="$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessCountFile"/>
                </fileName>
            </pfx2:RemoveActivityInputClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="ReadCountFile">
        <pd:type>com.tibco.plugin.file.FileReadActivity</pd:type>
        <pd:resourceType>ae.activities.FileReadActivity</pd:resourceType>
        <pd:x>85</pd:x>
        <pd:y>372</pd:y>
        <config>
            <encoding>text</encoding>
        </config>
        <pd:inputBindings>
            <ns:ReadActivityInputClass>
                <fileName>
                    <xsl:value-of select="$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessCountFile"/>
                </fileName>
            </ns:ReadActivityInputClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="CreateCurrentCountFile">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>475</pd:x>
        <pd:y>541</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
        </config>
        <pd:inputBindings>
            <pfx2:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessCountFile"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="&quot;START&quot;"/>
                </textContent>
            </pfx2:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="MapReadFileError">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>534</pd:x>
        <pd:y>353</pd:y>
        <config>
            <element>
                <xsd:element name="ErrorMsg">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element name="Msg" type="xsd:string"/>
                        </xsd:sequence>
                    </xsd:complexType>
                </xsd:element>
            </element>
        </config>
        <pd:inputBindings>
            <ErrorMsg>
                <Msg>
                    <xsl:value-of select="$_error/ns1:ErrorReport/Class"/>
                </Msg>
            </ErrorMsg>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Catch">
        <pd:type>com.tibco.pe.core.CatchActivity</pd:type>
        <pd:resourceType>ae.activities.catch</pd:resourceType>
        <pd:x>1149</pd:x>
        <pd:y>41</pd:y>
        <pd:handler>true</pd:handler>
        <config>
            <catchAll>true</catchAll>
        </config>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="DescStepNoData">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>220</pd:x>
        <pd:y>85</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
            <append>false</append>
        </config>
        <pd:inputBindings>
            <pfx2:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessCountFile"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="concat(&quot;NODATA:&quot;,tib:substring-after-last($ReadCountFile/pfx2:ReadActivityOutputTextClass/fileContent/textContent, ':') - 1 )"/>
                </textContent>
            </pfx2:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="RemoveFileNoData">
        <pd:type>com.tibco.plugin.file.FileRemoveActivity</pd:type>
        <pd:resourceType>ae.activities.FileRemoveActivity</pd:resourceType>
        <pd:x>365</pd:x>
        <pd:y>151</pd:y>
        <config/>
        <pd:inputBindings>
            <pfx2:RemoveActivityInputClass>
                <fileName>
                    <xsl:value-of select="$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessCountFile"/>
                </fileName>
            </pfx2:RemoveActivityInputClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="NoRecordProcessFile">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>902</pd:x>
        <pd:y>236</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
            <append>false</append>
        </config>
        <pd:inputBindings>
            <pfx2:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessCountFile"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="concat(&quot;NODATA:&quot;,$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/NoDataStep)"/>
                </textContent>
            </pfx2:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="ApprendProcessFile">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>710</pd:x>
        <pd:y>506</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
            <append>true</append>
        </config>
        <pd:inputBindings>
            <pfx2:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessCountFile"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="&quot;PROCESS:&quot;"/>
                </textContent>
            </pfx2:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="QueryError">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>898</pd:x>
        <pd:y>401</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:transition>
        <pd:from>QueryBTTVGW</pd:from>
        <pd:to>ApprendProcessFile</pd:to>
        <pd:xpathDescription>Has record</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>count($QueryBTTVGW/resultSet/Record)&gt;0</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Group</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>InitProcess</pd:from>
        <pd:to>Group</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Null</pd:from>
        <pd:to>CreateCurrentCountFile</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Remove File</pd:from>
        <pd:to>CreateCurrentCountFile</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Remove File</pd:from>
        <pd:to>Null</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>error</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>ReadCountFile</pd:from>
        <pd:to>Remove File</pd:to>
        <pd:xpathDescription>StartNewSession</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>string-length($ReadCountFile/pfx2:ReadActivityOutputTextClass/fileContent/textContent)=$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/ProcessNumber + 13</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Timer</pd:from>
        <pd:to>ReadCountFile</pd:to>
        <pd:xpathDescription>RunningTime</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>($_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/RunAllTime='false'  and
tib:create-time(tib:get-hours-from-dateTime(current-dateTime()), tib:get-minutes-from-dateTime(current-dateTime()), tib:get-seconds-from-dateTime(current-dateTime()))  &gt;= tib:parse-time('HH:mm:ss',$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/WorkingTimeStart) and 
tib:create-time(tib:get-hours-from-dateTime(current-dateTime()), tib:get-minutes-from-dateTime(current-dateTime()), tib:get-seconds-from-dateTime(current-dateTime()))  &lt;= tib:parse-time('HH:mm:ss',$_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/WorkingTimeEnd))
or $_globalVariables/pfx:GlobalVariables/ServiceGlobalVar/BTTVIn/RunAllTime='true'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>QueryBTTVGW</pd:from>
        <pd:to>NoRecordProcessFile</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>CreateCurrentCountFile</pd:from>
        <pd:to>QueryBTTVGW</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>ReadCountFile</pd:from>
        <pd:to>MapReadFileError</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>error</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>MapReadFileError</pd:from>
        <pd:to>Null</pd:to>
        <pd:xpathDescription>FileNotFound</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$MapReadFileError/ErrorMsg/Msg='FileNotFoundException'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>MapReadFileError</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Catch</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Timer</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>ReadCountFile</pd:from>
        <pd:to>DescStepNoData</pd:to>
        <pd:xpathDescription>NODATA</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>contains($ReadCountFile/pfx2:ReadActivityOutputTextClass/fileContent/textContent,'NODATA')</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>DescStepNoData</pd:from>
        <pd:to>RemoveFileNoData</pd:to>
        <pd:xpathDescription>end no data step</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>tib:substring-after-last($ReadCountFile/pfx2:ReadActivityOutputTextClass/fileContent/textContent, ':') = '0'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>RemoveFileNoData</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>NoRecordProcessFile</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>DescStepNoData</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>ApprendProcessFile</pd:from>
        <pd:to>InitProcess</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>QueryBTTVGW</pd:from>
        <pd:to>QueryError</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>error</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>QueryError</pd:from>
        <pd:to>NoRecordProcessFile</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>ReadCountFile</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
</pd:ProcessDefinition>