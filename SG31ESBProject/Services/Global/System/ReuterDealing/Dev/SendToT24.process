<?xml version="1.0" encoding="UTF-8"?>
<pd:ProcessDefinition xmlns:BW="java://com.tibco.pe.core.JavaCustomXPATHFunctions" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns14="sbv/common/envelope/soaenvelope/1.0" xmlns:ns="http://www.tibco.com/pe/CheckpointSchema" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:ns22="sbv/common/envelope/serviceenvelope/1.0" xmlns:ns12="schema://www.sbv.gov.vn/schema/global/system/ReuterDealing/SyncReuterDealingData.xsd" xmlns:ns13="sbv/common/logging/enginelog/1.0" xmlns:pfx="sbv/common/envelope/commonheader/1.0" xmlns:pd="http://xmlns.tibco.com/bw/process/2003" xmlns:ns2="http://www.tibco.com/pe/EngineTypes" xmlns:ns1="http://www.tibco.com/pe/DeployedVarsType" xmlns:pfx5="http://temenos.com/SBV.INTE.T24.PORTAL.WS" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:pfx4="http://temenos.com/SBV.INTE.T24.REUTER.WS" xmlns:tib="http://www.tibco.com/bw/xslt/custom-functions" xmlns:pfx3="http://www.tibco.com/schemas/SG31ESBProject/SharedResource/Schema/Global/System/ESB/Common/ESBCommonModel.xsd" xmlns:pfx2="schema://www.sbv.gov.vn/schema/global/system/ReuterDealing/ReuterToT24.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <xsd:import namespace="sbv/common/envelope/commonheader/1.0" schemaLocation="/SharedResource/Schema/Common/Envelope/CommonHeader.xsd"/>
    <xsd:import namespace="http://temenos.com/SBV.INTE.T24.REUTER.WS" schemaLocation="/SharedResource/Schema/Global/System/T24/Reuter/SBV.INTE.T24.REUTER.WS.xsd"/>
    <xsd:import namespace="schema://www.sbv.gov.vn/schema/global/system/ReuterDealing/ReuterToT24.xsd" schemaLocation="/SharedResource/Schema/Global/System/ReuterDealing/T24Reuter/ReuterToT24.xsd"/>
    <wsdl:import namespace="http://temenos.com/SBV.INTE.T24.REUTER.WS" location="/SharedResource/Schema/Global/System/T24/Reuter/SBV.INTE.T24.REUTER.WS.wsdl"/>
    <pd:name>Services/Global/System/ReuterDealing/Dev/SendToT24.process</pd:name>
    <pd:startName>Start</pd:startName>
    <pd:startType>
        <xsd:element name="DataInput">
            <xsd:complexType>
                <xsd:sequence>
                    <xsd:element ref="pfx2:ReuterRecord"/>
                    <xsd:element name="ServiceManage">
                        <xsd:complexType>
                            <xsd:sequence>
                                <xsd:element ref="pfx2:ESBServiceState" minOccurs="0"/>
                                <xsd:element ref="pfx:AppHdr" minOccurs="0"/>
                                <xsd:element ref="pfx2:UpdateDBModel" minOccurs="0"/>
                            </xsd:sequence>
                        </xsd:complexType>
                    </xsd:element>
                </xsd:sequence>
            </xsd:complexType>
        </xsd:element>
    </pd:startType>
    <pd:startX>169</pd:startX>
    <pd:startY>429</pd:startY>
    <pd:returnBindings>
        <DataOutput>
            <xsl:copy-of select="$Start/DataInput/pfx2:ReuterRecord"/>
            <ServiceManage>
                <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/ancestor-or-self::*/namespace::node()"/>
                <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/@*"/>
                <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/node()"/>
            </ServiceManage>
        </DataOutput>
    </pd:returnBindings>
    <pd:endName>End</pd:endName>
    <pd:endType>
        <xsd:element name="DataOutput">
            <xsd:complexType>
                <xsd:sequence>
                    <xsd:element ref="pfx2:ReuterRecord"/>
                    <xsd:element name="ServiceManage">
                        <xsd:complexType>
                            <xsd:sequence>
                                <xsd:element ref="pfx2:ESBServiceState" minOccurs="0"/>
                                <xsd:element ref="pfx:AppHdr" minOccurs="0"/>
                                <xsd:element ref="pfx2:UpdateDBModel" minOccurs="0"/>
                            </xsd:sequence>
                        </xsd:complexType>
                    </xsd:element>
                </xsd:sequence>
            </xsd:complexType>
        </xsd:element>
    </pd:endType>
    <pd:endX>1618</pd:endX>
    <pd:endY>436</pd:endY>
    <pd:errorSchemas/>
    <pd:processVariables>
        <ServiceManage ref="pfx2:ServiceManage"/>
    </pd:processVariables>
    <pd:targetNamespace>http://xmlns.example.com/1469001975276</pd:targetNamespace>
    <pd:activity name="FXSpotdealInput">
        <pd:type>com.tibco.plugin.soap.SOAPSendReceiveActivity</pd:type>
        <pd:resourceType>ae.activities.SOAPSendReceiveUI</pd:resourceType>
        <pd:x>764</pd:x>
        <pd:y>247</pd:y>
        <config>
            <timeout>%%ServiceGlobalVar/Reuter/ReuterToT24/T24WS_Timeout_sec%%</timeout>
            <soapAttachmentStyle>SwA</soapAttachmentStyle>
            <timeoutType>Seconds</timeoutType>
            <service>pfx4:T24WebServicesImplService</service>
            <servicePort>T24WebServicesImplPort</servicePort>
            <operation>FXSpotdealInput</operation>
            <soapAction/>
            <endpointURL>%%T24WS/T24WSReuter%%</endpointURL>
            <authScheme>NONE</authScheme>
        </config>
        <pd:inputBindings>
            <inputMessage>
                <xsl:copy-of select="$Map-To-T24-Model---Spot/pfx4:FXSpotdealInput"/>
            </inputMessage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Spot-Internal">
        <pd:type>com.tibco.plugin.soap.SOAPSendReceiveActivity</pd:type>
        <pd:resourceType>ae.activities.SOAPSendReceiveUI</pd:resourceType>
        <pd:x>760</pd:x>
        <pd:y>585</pd:y>
        <config>
            <timeout>%%ServiceGlobalVar/Reuter/ReuterToT24/T24WS_Timeout_sec%%</timeout>
            <soapAttachmentStyle>SwA</soapAttachmentStyle>
            <timeoutType>Seconds</timeoutType>
            <service>pfx4:T24WebServicesImplService</service>
            <servicePort>T24WebServicesImplPort</servicePort>
            <operation>FXSpotdealInternalInput</operation>
            <soapAction/>
            <endpointURL>%%T24WS/T24WSReuter%%</endpointURL>
            <authScheme>NONE</authScheme>
        </config>
        <pd:inputBindings>
            <inputMessage>
                <xsl:copy-of select="$Map-To-T24-Model---Spot-Internal/pfx4:FXSpotdealInternalInput"/>
            </inputMessage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="NavigateOnly">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>1206</pd:x>
        <pd:y>437</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="0.Update SM - Success">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1030</pd:x>
        <pd:y>176</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <pfx2:ESBServiceState>
                    <pfx3:Status>
                        <xsl:value-of select="0"/>
                    </pfx3:Status>
                    <pfx3:ErrorExist>
                        <xsl:value-of select="&quot;false&quot;"/>
                    </pfx3:ErrorExist>
                    <pfx3:Unique_ID>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Unique_ID"/>
                    </pfx3:Unique_ID>
                    <pfx3:timestamps>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                    </pfx3:timestamps>
                    <pfx3:CurrentDateTime>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:CurrentDateTime"/>
                    </pfx3:CurrentDateTime>
                </pfx2:ESBServiceState>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/pfx:AppHdr"/>
                <pfx2:UpdateDBModel>
                    <pfx2:status>
                        <xsl:value-of select="0"/>
                    </pfx2:status>
                    <xsl:if test="$FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/transactionId">
                        <pfx2:err_msg>
                            <xsl:value-of select="$FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/transactionId"/>
                        </pfx2:err_msg>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <pfx2:id>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </pfx2:id>
                    </xsl:if>
                </pfx2:UpdateDBModel>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="2.Update SM - Other Res">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1029</pd:x>
        <pd:y>248</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <pfx2:ESBServiceState>
                    <pfx3:Status>
                        <xsl:value-of select="2"/>
                    </pfx3:Status>
                    <pfx3:ErrorMessage>
                        <xsl:value-of select="concat(&quot; T24 WS Response  : &quot; ,$FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/successIndicator, &quot;Msg : &quot;  , $FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/messages[1] )"/>
                    </pfx3:ErrorMessage>
                    <pfx3:NotifyMsg>
                        <xsl:value-of select="concat(&quot; T24 WS Response  : &quot; ,$FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/successIndicator, &quot;Msg : &quot;  , $FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/messages[1] )"/>
                    </pfx3:NotifyMsg>
                    <pfx3:ErrorExist>
                        <xsl:value-of select="&quot;false&quot;"/>
                    </pfx3:ErrorExist>
                    <pfx3:Unique_ID>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Unique_ID"/>
                    </pfx3:Unique_ID>
                    <pfx3:timestamps>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                    </pfx3:timestamps>
                    <pfx3:CurrentDateTime>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:CurrentDateTime"/>
                    </pfx3:CurrentDateTime>
                </pfx2:ESBServiceState>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/pfx:AppHdr"/>
                <pfx2:UpdateDBModel>
                    <pfx2:status>
                        <xsl:value-of select="2"/>
                    </pfx2:status>
                    <pfx2:err_msg>
                        <xsl:value-of select="concat(&quot; T24 WS Response  : &quot; ,$FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/successIndicator, &quot;Msg : &quot;  , $FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/messages[1] )"/>
                    </pfx2:err_msg>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <pfx2:id>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </pfx2:id>
                    </xsl:if>
                </pfx2:UpdateDBModel>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="3.Update SM - Timeout">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1029</pd:x>
        <pd:y>316</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <pfx2:ESBServiceState>
                    <pfx3:Status>
                        <xsl:value-of select="3"/>
                    </pfx3:Status>
                    <pfx3:ErrorMessage>
                        <xsl:value-of select="concat(&quot;T24WS Timeout : &quot; , $_error/ns2:ErrorReport/Msg )"/>
                    </pfx3:ErrorMessage>
                    <pfx3:NotifyMsg>
                        <xsl:value-of select="concat(&quot;T24WS Timeout : &quot; , $_error/ns2:ErrorReport/Msg )"/>
                    </pfx3:NotifyMsg>
                    <pfx3:ErrorExist>
                        <xsl:value-of select="&quot;true&quot;"/>
                    </pfx3:ErrorExist>
                    <pfx3:Unique_ID>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Unique_ID"/>
                    </pfx3:Unique_ID>
                    <pfx3:timestamps>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                    </pfx3:timestamps>
                    <pfx3:CurrentDateTime>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:CurrentDateTime"/>
                    </pfx3:CurrentDateTime>
                </pfx2:ESBServiceState>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/pfx:AppHdr"/>
                <pfx2:UpdateDBModel>
                    <pfx2:status>
                        <xsl:value-of select="3"/>
                    </pfx2:status>
                    <pfx2:err_msg>
                        <xsl:value-of select="concat(&quot;T24WS Timeout : &quot; , $_error/ns2:ErrorReport/Msg )"/>
                    </pfx2:err_msg>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <pfx2:id>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </pfx2:id>
                    </xsl:if>
                </pfx2:UpdateDBModel>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="4.Update SM - Other Error">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1029</pd:x>
        <pd:y>396</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <pfx2:ESBServiceState>
                    <pfx3:Status>
                        <xsl:value-of select="4"/>
                    </pfx3:Status>
                    <pfx3:ErrorMessage>
                        <xsl:value-of select="concat(&quot;Other  T24 WS Error : &quot;  , $_error/ns2:ErrorReport/Msg)"/>
                    </pfx3:ErrorMessage>
                    <pfx3:NotifyMsg>
                        <xsl:value-of select="concat(&quot;Other  T24 WS Error : &quot;  , $_error/ns2:ErrorReport/Msg)"/>
                    </pfx3:NotifyMsg>
                    <pfx3:ErrorExist>
                        <xsl:value-of select="&quot;true&quot;"/>
                    </pfx3:ErrorExist>
                    <pfx3:Unique_ID>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Unique_ID"/>
                    </pfx3:Unique_ID>
                    <pfx3:timestamps>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                    </pfx3:timestamps>
                    <pfx3:CurrentDateTime>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:CurrentDateTime"/>
                    </pfx3:CurrentDateTime>
                </pfx2:ESBServiceState>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/pfx:AppHdr"/>
                <pfx2:UpdateDBModel>
                    <pfx2:status>
                        <xsl:value-of select="4"/>
                    </pfx2:status>
                    <pfx2:err_msg>
                        <xsl:value-of select="concat(&quot;[ProcessErr]-Other  T24 WS Error : &quot;  , $_error/ns2:ErrorReport/Msg)"/>
                    </pfx2:err_msg>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <pfx2:id>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </pfx2:id>
                    </xsl:if>
                </pfx2:UpdateDBModel>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Map To T24 Model - Spot">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>646</pd:x>
        <pd:y>253</pd:y>
        <config>
            <element ref="pfx4:FXSpotdealInput"/>
        </config>
        <pd:inputBindings>
            <pfx4:FXSpotdealInput>
                <WebRequestCommon>
                    <company>
                        <xsl:value-of select="&quot;VN0010001&quot;"/>
                    </company>
                    <password>
                        <xsl:value-of select="$_globalVariables/ns1:GlobalVariables/T24Authentication/T24ReuterPass"/>
                    </password>
                    <userName>
                        <xsl:value-of select="$_globalVariables/ns1:GlobalVariables/T24Authentication/T24ReuterUser"/>
                    </userName>
                </WebRequestCommon>
                <OfsFunction>
                    <activityName>
                        <xsl:value-of select="&quot;&quot;"/>
                    </activityName>
                    <assignReason>
                        <xsl:value-of select="&quot;&quot;"/>
                    </assignReason>
                    <dueDate>
                        <xsl:value-of select="&quot;&quot;"/>
                    </dueDate>
                    <extProcess>
                        <xsl:value-of select="&quot;&quot;"/>
                    </extProcess>
                    <extProcessID>
                        <xsl:value-of select="&quot;&quot;"/>
                    </extProcessID>
                    <gtsControl>
                        <xsl:value-of select="&quot;&quot;"/>
                    </gtsControl>
                    <messageId>
                        <xsl:value-of select="&quot;&quot;"/>
                    </messageId>
                    <noOfAuth>
                        <xsl:value-of select="&quot;&quot;"/>
                    </noOfAuth>
                    <owner>
                        <xsl:value-of select="&quot;&quot;"/>
                    </owner>
                    <replace>
                        <xsl:value-of select="&quot;&quot;"/>
                    </replace>
                    <startDate>
                        <xsl:value-of select="&quot;&quot;"/>
                    </startDate>
                    <user>
                        <xsl:value-of select="&quot;&quot;"/>
                    </user>
                </OfsFunction>
                <FOREXREUTERSPOTDEALSBVINPType>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Currency1">
                        <CurrencyBought>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Currency1"/>
                        </CurrencyBought>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:DealVolumeCurrency1">
                        <BuyAmount>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:DealVolumeCurrency1"/>
                        </BuyAmount>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:ValueDatePeriod1Currency1">
                        <ValueDateBuy>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:ValueDatePeriod1Currency1"/>
                        </ValueDateBuy>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Currency2">
                        <CurrencySold>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Currency2"/>
                        </CurrencySold>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:ValueDatePeriod1Currency2">
                        <ValueDateSell>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:ValueDatePeriod1Currency2"/>
                        </ValueDateSell>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:ExchangeRatePeriod1">
                        <SpotRate>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:ExchangeRatePeriod1"/>
                        </SpotRate>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:TimeOfDeal">
                        <DealDate>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:TimeOfDeal"/>
                        </DealDate>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <BBRerterreference>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </BBRerterreference>
                    </xsl:if>
                </FOREXREUTERSPOTDEALSBVINPType>
            </pfx4:FXSpotdealInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Map To T24 Model - Spot Internal">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>646</pd:x>
        <pd:y>591</pd:y>
        <config>
            <element ref="pfx4:FXSpotdealInternalInput"/>
        </config>
        <pd:inputBindings>
            <pfx4:FXSpotdealInternalInput>
                <WebRequestCommon>
                    <company>
                        <xsl:value-of select="&quot;VN0010001&quot;"/>
                    </company>
                    <password>
                        <xsl:value-of select="$_globalVariables/ns1:GlobalVariables/T24Authentication/T24ReuterPass"/>
                    </password>
                    <userName>
                        <xsl:value-of select="$_globalVariables/ns1:GlobalVariables/T24Authentication/T24ReuterUser"/>
                    </userName>
                </WebRequestCommon>
                <OfsFunction>
                    <activityName>
                        <xsl:value-of select="&quot;&quot;"/>
                    </activityName>
                    <assignReason>
                        <xsl:value-of select="&quot;&quot;"/>
                    </assignReason>
                    <dueDate>
                        <xsl:value-of select="&quot;&quot;"/>
                    </dueDate>
                    <extProcess>
                        <xsl:value-of select="&quot;&quot;"/>
                    </extProcess>
                    <extProcessID>
                        <xsl:value-of select="&quot;&quot;"/>
                    </extProcessID>
                    <gtsControl>
                        <xsl:value-of select="&quot;&quot;"/>
                    </gtsControl>
                    <messageId>
                        <xsl:value-of select="&quot;&quot;"/>
                    </messageId>
                    <noOfAuth>
                        <xsl:value-of select="&quot;&quot;"/>
                    </noOfAuth>
                    <owner>
                        <xsl:value-of select="&quot;&quot;"/>
                    </owner>
                    <replace>
                        <xsl:value-of select="&quot;&quot;"/>
                    </replace>
                    <startDate>
                        <xsl:value-of select="&quot;&quot;"/>
                    </startDate>
                    <user>
                        <xsl:value-of select="&quot;&quot;"/>
                    </user>
                </OfsFunction>
                <FOREXREUTERSPOTDEALSBVIBType>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Currency1">
                        <CurrencyBought>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Currency1"/>
                        </CurrencyBought>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:DealVolumeCurrency1">
                        <BuyAmount>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:DealVolumeCurrency1"/>
                        </BuyAmount>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:ValueDatePeriod1Currency1">
                        <ValueDate>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:ValueDatePeriod1Currency1"/>
                        </ValueDate>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Currency2">
                        <CurrencySold>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Currency2"/>
                        </CurrencySold>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:ExchangeRatePeriod1">
                        <SpotRate>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:ExchangeRatePeriod1"/>
                        </SpotRate>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:TimeOfDeal">
                        <DealDate>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:TimeOfDeal"/>
                        </DealDate>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <BBRerterreference>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </BBRerterreference>
                    </xsl:if>
                </FOREXREUTERSPOTDEALSBVIBType>
            </pfx4:FXSpotdealInternalInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Update GW">
        <pd:type>com.tibco.plugin.jdbc.JDBCUpdateActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCUpdateActivity</pd:resourceType>
        <pd:x>1347</pd:x>
        <pd:y>437</pd:y>
        <config>
            <timeout>%%ServiceGlobalVar/Reuter/ReuterToT24/JDBCTimeout_sec%%</timeout>
            <commit>false</commit>
            <emptyStrAsNil>false</emptyStrAsNil>
            <statement>UPDATE Reuter_Gw r
SET r.status = ?,
err_msg = ?
WHERE r.id = ?</statement>
            <jdbcSharedConfig>/SharedResource/Connection/Jdbc/AMXSOA.sharedjdbc</jdbcSharedConfig>
            <Prepared_Param_DataType>
                <parameter>
                    <parameterName>status</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
                <parameter>
                    <parameterName>err_msg</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
                <parameter>
                    <parameterName>id</parameterName>
                    <dataType>INTEGER</dataType>
                </parameter>
            </Prepared_Param_DataType>
        </config>
        <pd:inputBindings>
            <jdbcUpdateActivityInput>
                <status>
                    <xsl:choose>
                        <xsl:when test="exists($ServiceManage/pfx2:ServiceManage/pfx2:UpdateDBModel/pfx2:status)">
                            <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:UpdateDBModel/pfx2:status"/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:attribute name="xsi:nil">true</xsl:attribute>
                        </xsl:otherwise>
                    </xsl:choose>
                </status>
                <err_msg>
                    <xsl:choose>
                        <xsl:when test="exists($ServiceManage/pfx2:ServiceManage/pfx2:UpdateDBModel/pfx2:err_msg)">
                            <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:UpdateDBModel/pfx2:err_msg"/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:attribute name="xsi:nil">true</xsl:attribute>
                        </xsl:otherwise>
                    </xsl:choose>
                </err_msg>
                <id>
                    <xsl:choose>
                        <xsl:when test="exists($ServiceManage/pfx2:ServiceManage/pfx2:UpdateDBModel/pfx2:id)">
                            <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:UpdateDBModel/pfx2:id"/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:attribute name="xsi:nil">true</xsl:attribute>
                        </xsl:otherwise>
                    </xsl:choose>
                </id>
            </jdbcUpdateActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="T24Response">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>876</pd:x>
        <pd:y>200</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="WSError">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>876</pd:x>
        <pd:y>343</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Init SM">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>301</pd:x>
        <pd:y>427</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/ancestor-or-self::*/namespace::node()"/>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/@*"/>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/node()"/>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="No Write Logs">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>1352</pd:x>
        <pd:y>613</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="LogEnd">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>1458</pd:x>
        <pd:y>436</pd:y>
        <config>
            <processName>/Util/Logging/handleLog.process</processName>
            <spawn>false</spawn>
        </config>
        <pd:inputBindings>
            <root>
                <EnableRoles>
                    <xsl:value-of select="$_globalVariables/ns1:GlobalVariables/LogCategory/DebugRole"/>
                </EnableRoles>
                <ns13:EngineLog>
                    <ns13:ServiceName>
                        <xsl:value-of select="&quot;SendToT24&quot;"/>
                    </ns13:ServiceName>
                    <ns13:Message>
                        <xsl:value-of select="concat( 'SendToT24' ,': End ', 'SendToT24' )"/>
                    </ns13:Message>
                    <ns13:Category>
                        <xsl:value-of select="$_globalVariables/ns1:GlobalVariables/EnableRoles"/>
                    </ns13:Category>
                    <ns13:TrackingId>
                        <xsl:value-of select="concat( generate-id($_processContext/ns2:ProcessContext/ProcessId),   tib:timestamp() )"/>
                    </ns13:TrackingId>
                </ns13:EngineLog>
                <ns14:SOAEnvelope>
                    <ns14:SOAServiceHeader>
                        <ns14:AppHdr>
                            <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/pfx:AppHdr/ancestor-or-self::*/namespace::node()"/>
                            <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/pfx:AppHdr/@*"/>
                            <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/pfx:AppHdr/node()"/>
                        </ns14:AppHdr>
                        <ns14:SOAMsgId>
                            <xsl:value-of select="concat( generate-id($_processContext/ns2:ProcessContext/ProcessId),   tib:timestamp() )"/>
                        </ns14:SOAMsgId>
                        <ns14:ServiceName>
                            <xsl:value-of select="&quot;Global/System/ReuterDealing/SendToT24&quot;"/>
                        </ns14:ServiceName>
                        <ns14:OperationName>
                            <xsl:value-of select="&quot;SendToT24&quot;"/>
                        </ns14:OperationName>
                        <ns14:ProcessName>
                            <xsl:value-of select="BW:getCurrentProcessName($_processContext/ns2:ProcessContext/ProcessId)"/>
                        </ns14:ProcessName>
                    </ns14:SOAServiceHeader>
                    <ns14:ServiceBody>
                        <ns22:ServiceEnverlop>
                            <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/pfx:AppHdr"/>
                            <pfx:ResponseStatus>
                                <pfx:Status>
                                    <xsl:value-of select="if ($ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Status = 0)&#xA;then 0&#xA;else 1"/>
                                </pfx:Status>
                                <pfx:ErrorCode>
                                    <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Status"/>
                                </pfx:ErrorCode>
                                <pfx:ErrorMessage>
                                    <xsl:value-of select="substring($ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:ErrorMessage, 1 , 200 )"/>
                                </pfx:ErrorMessage>
                                <pfx:ErrorInfo/>
                            </pfx:ResponseStatus>
                            <ServiceBody>
                                <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage"/>
                                <xsl:copy-of select="$FXSpotdealInput/outputMessage"/>
                                <xsl:copy-of select="$Spot-Internal/outputMessage"/>
                                <xsl:copy-of select="$Update-GW/jdbcUpdateActivityOutput/noOfUpdates"/>
                            </ServiceBody>
                        </ns22:ServiceEnverlop>
                    </ns14:ServiceBody>
                </ns14:SOAEnvelope>
                <Direction>
                    <xsl:value-of select="&quot;End&quot;"/>
                </Direction>
                <TimeDuration>
                    <xsl:value-of select="tib:timestamp() - $ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                </TimeDuration>
            </root>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Navigate End">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>1525</pd:x>
        <pd:y>503</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="WSError-1">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>876</pd:x>
        <pd:y>652</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="T24Response-Internal">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>875</pd:x>
        <pd:y>506</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="0.Update-SM-Internal">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1029</pd:x>
        <pd:y>467</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <pfx2:ESBServiceState>
                    <pfx3:Status>
                        <xsl:value-of select="0"/>
                    </pfx3:Status>
                    <pfx3:ErrorExist>
                        <xsl:value-of select="&quot;false&quot;"/>
                    </pfx3:ErrorExist>
                    <pfx3:Unique_ID>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Unique_ID"/>
                    </pfx3:Unique_ID>
                    <pfx3:timestamps>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                    </pfx3:timestamps>
                    <pfx3:CurrentDateTime>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:CurrentDateTime"/>
                    </pfx3:CurrentDateTime>
                </pfx2:ESBServiceState>
                <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/pfx:AppHdr"/>
                <pfx2:UpdateDBModel>
                    <pfx2:status>
                        <xsl:value-of select="0"/>
                    </pfx2:status>
                    <xsl:if test="$Spot-Internal/outputMessage/pfx4:FXSpotdealInternalInputResponse/Status/transactionId">
                        <pfx2:err_msg>
                            <xsl:value-of select="$Spot-Internal/outputMessage/pfx4:FXSpotdealInternalInputResponse/Status/transactionId"/>
                        </pfx2:err_msg>
                    </xsl:if>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <pfx2:id>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </pfx2:id>
                    </xsl:if>
                </pfx2:UpdateDBModel>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="2.Update SM - Other Res-Internal">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1030</pd:x>
        <pd:y>548</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <pfx2:ESBServiceState>
                    <pfx3:Status>
                        <xsl:value-of select="2"/>
                    </pfx3:Status>
                    <pfx3:ErrorMessage>
                        <xsl:value-of select="concat(&quot; T24 WS Response  : &quot; ,$Spot-Internal/outputMessage/pfx4:FXSpotdealInternalInputResponse/Status/successIndicator, &quot;Msg : &quot;  , $Spot-Internal/outputMessage/pfx4:FXSpotdealInternalInputResponse/Status/messages[1] )"/>
                    </pfx3:ErrorMessage>
                    <pfx3:NotifyMsg>
                        <xsl:value-of select="concat(&quot; T24 WS Response  : &quot; ,$Spot-Internal/outputMessage/pfx4:FXSpotdealInternalInputResponse/Status/successIndicator, &quot;Msg : &quot;  , $Spot-Internal/outputMessage/pfx4:FXSpotdealInternalInputResponse/Status/messages[1] )"/>
                    </pfx3:NotifyMsg>
                    <pfx3:ErrorExist>
                        <xsl:value-of select="&quot;false&quot;"/>
                    </pfx3:ErrorExist>
                    <pfx3:Unique_ID>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Unique_ID"/>
                    </pfx3:Unique_ID>
                    <pfx3:timestamps>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                    </pfx3:timestamps>
                    <pfx3:CurrentDateTime>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:CurrentDateTime"/>
                    </pfx3:CurrentDateTime>
                </pfx2:ESBServiceState>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/pfx:AppHdr"/>
                <pfx2:UpdateDBModel>
                    <pfx2:status>
                        <xsl:value-of select="2"/>
                    </pfx2:status>
                    <pfx2:err_msg>
                        <xsl:value-of select="concat(&quot; T24 WS Response  : &quot; , $Spot-Internal/outputMessage/pfx4:FXSpotdealInternalInputResponse/Status/successIndicator, &quot;Msg : &quot;  , $Spot-Internal/outputMessage/pfx4:FXSpotdealInternalInputResponse/Status/messages[1] )"/>
                    </pfx2:err_msg>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <pfx2:id>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </pfx2:id>
                    </xsl:if>
                </pfx2:UpdateDBModel>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="3.Update SM - Timeout - Internal">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1032</pd:x>
        <pd:y>619</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <pfx2:ESBServiceState>
                    <pfx3:Status>
                        <xsl:value-of select="3"/>
                    </pfx3:Status>
                    <pfx3:ErrorMessage>
                        <xsl:value-of select="concat(&quot;T24WS Timeout : &quot; , $_error/ns2:ErrorReport/Msg )"/>
                    </pfx3:ErrorMessage>
                    <pfx3:NotifyMsg>
                        <xsl:value-of select="concat(&quot;T24WS Timeout : &quot; , $_error/ns2:ErrorReport/Msg )"/>
                    </pfx3:NotifyMsg>
                    <pfx3:ErrorExist>
                        <xsl:value-of select="&quot;true&quot;"/>
                    </pfx3:ErrorExist>
                    <pfx3:Unique_ID>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Unique_ID"/>
                    </pfx3:Unique_ID>
                    <pfx3:timestamps>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                    </pfx3:timestamps>
                    <pfx3:CurrentDateTime>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:CurrentDateTime"/>
                    </pfx3:CurrentDateTime>
                </pfx2:ESBServiceState>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/pfx:AppHdr"/>
                <pfx2:UpdateDBModel>
                    <pfx2:status>
                        <xsl:value-of select="3"/>
                    </pfx2:status>
                    <pfx2:err_msg>
                        <xsl:value-of select="concat(&quot;T24WS Timeout : &quot; , $_error/ns2:ErrorReport/Msg )"/>
                    </pfx2:err_msg>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <pfx2:id>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </pfx2:id>
                    </xsl:if>
                </pfx2:UpdateDBModel>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="4.Update SM - Other Error - Internal">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1032</pd:x>
        <pd:y>695</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <pfx2:ESBServiceState>
                    <pfx3:Status>
                        <xsl:value-of select="4"/>
                    </pfx3:Status>
                    <pfx3:ErrorMessage>
                        <xsl:value-of select="concat(&quot;Other  T24 WS Error : &quot;  , $_error/ns2:ErrorReport/Msg)"/>
                    </pfx3:ErrorMessage>
                    <pfx3:NotifyMsg>
                        <xsl:value-of select="concat(&quot;Other  T24 WS Error : &quot;  , $_error/ns2:ErrorReport/Msg)"/>
                    </pfx3:NotifyMsg>
                    <pfx3:ErrorExist>
                        <xsl:value-of select="&quot;true&quot;"/>
                    </pfx3:ErrorExist>
                    <pfx3:Unique_ID>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Unique_ID"/>
                    </pfx3:Unique_ID>
                    <pfx3:timestamps>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                    </pfx3:timestamps>
                    <pfx3:CurrentDateTime>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:CurrentDateTime"/>
                    </pfx3:CurrentDateTime>
                </pfx2:ESBServiceState>
                <xsl:copy-of select="$Start/DataInput/ServiceManage/pfx:AppHdr"/>
                <pfx2:UpdateDBModel>
                    <pfx2:status>
                        <xsl:value-of select="4"/>
                    </pfx2:status>
                    <pfx2:err_msg>
                        <xsl:value-of select="concat(&quot;[ProcessErr]-Other  T24 WS Error : &quot;  , $_error/ns2:ErrorReport/Msg)"/>
                    </pfx2:err_msg>
                    <xsl:if test="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id">
                        <pfx2:id>
                            <xsl:value-of select="$Start/DataInput/pfx2:ReuterRecord/pfx2:Id"/>
                        </pfx2:id>
                    </xsl:if>
                </pfx2:UpdateDBModel>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Navigate">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>437</pd:x>
        <pd:y>428</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="go to End">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>1348</pd:x>
        <pd:y>549</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Catch Unexpected Exception">
        <pd:type>com.tibco.pe.core.CatchActivity</pd:type>
        <pd:resourceType>ae.activities.catch</pd:resourceType>
        <pd:x>1615</pd:x>
        <pd:y>824</pd:y>
        <pd:handler>true</pd:handler>
        <config>
            <catchAll>true</catchAll>
        </config>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="99. Has Unexpected Exception">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1618</pd:x>
        <pd:y>690</pd:y>
        <config>
            <variableName>ServiceManage</variableName>
        </config>
        <pd:inputBindings>
            <pfx2:ServiceManage>
                <pfx2:ESBServiceState>
                    <pfx3:Status>
                        <xsl:value-of select="99"/>
                    </pfx3:Status>
                    <pfx3:ErrorMessage>
                        <xsl:value-of select="concat(&quot;Has Unexpected Exception &quot;, $_error/ns2:ErrorReport/Msg)"/>
                    </pfx3:ErrorMessage>
                    <pfx3:NotifyMsg>
                        <xsl:value-of select="concat(&quot;Has Unexpected Exception &quot;, $_error/ns2:ErrorReport/Msg)"/>
                    </pfx3:NotifyMsg>
                    <pfx3:ErrorExist>
                        <xsl:value-of select="&quot;true&quot;"/>
                    </pfx3:ErrorExist>
                    <pfx3:Unique_ID>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:Unique_ID"/>
                    </pfx3:Unique_ID>
                    <pfx3:timestamps>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:timestamps"/>
                    </pfx3:timestamps>
                    <pfx3:CurrentDateTime>
                        <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx3:CurrentDateTime"/>
                    </pfx3:CurrentDateTime>
                    <xsl:if test="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx2:InputDate">
                        <pfx2:InputDate>
                            <xsl:value-of select="$ServiceManage/pfx2:ServiceManage/pfx2:ESBServiceState/pfx2:InputDate"/>
                        </pfx2:InputDate>
                    </xsl:if>
                </pfx2:ESBServiceState>
                <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/pfx:AppHdr"/>
                <xsl:copy-of select="$ServiceManage/pfx2:ServiceManage/pfx2:UpdateDBModel"/>
            </pfx2:ServiceManage>
        </pd:inputBindings>
    </pd:activity>
    <pd:transition>
        <pd:from>NavigateOnly</pd:from>
        <pd:to>Update GW</pd:to>
        <pd:xpathDescription>Otherwise, has update</pd:xpathDescription>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Spot-Internal</pd:from>
        <pd:to>T24Response-Internal</pd:to>
        <pd:xpathDescription>Has Response</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>0.Update SM - Success</pd:from>
        <pd:to>NavigateOnly</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>2.Update SM - Other Res</pd:from>
        <pd:to>NavigateOnly</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>3.Update SM - Timeout</pd:from>
        <pd:to>NavigateOnly</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>4.Update SM - Other Error</pd:from>
        <pd:to>NavigateOnly</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Map To T24 Model - Spot</pd:from>
        <pd:to>FXSpotdealInput</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Map To T24 Model - Spot Internal</pd:from>
        <pd:to>Spot-Internal</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Start</pd:from>
        <pd:to>Init SM</pd:to>
        <pd:xpathDescription/>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Update GW</pd:from>
        <pd:to>LogEnd</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>FXSpotdealInput</pd:from>
        <pd:to>T24Response</pd:to>
        <pd:xpathDescription>Has Response</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>T24Response</pd:from>
        <pd:to>0.Update SM - Success</pd:to>
        <pd:xpathDescription>0.Success</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/successIndicator = 'Success'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>T24Response</pd:from>
        <pd:to>2.Update SM - Other Res</pd:to>
        <pd:xpathDescription>2.OtherRes</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>FXSpotdealInput</pd:from>
        <pd:to>WSError</pd:to>
        <pd:xpathDescription>Error, No Response</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>error</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>WSError</pd:from>
        <pd:to>3.Update SM - Timeout</pd:to>
        <pd:xpathDescription>3.Timeout</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$_error/ns2:ErrorReport/MsgCode = 'BWENGINE-100029'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>WSError</pd:from>
        <pd:to>4.Update SM - Other Error</pd:to>
        <pd:xpathDescription>4.OtherErr</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Init SM</pd:from>
        <pd:to>Navigate</pd:to>
        <pd:xpathDescription>Is FXSpot</pd:xpathDescription>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Start/DataInput/pfx2:ReuterRecord/pfx2:PureDealType = '2'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>NavigateOnly</pd:from>
        <pd:to>No Write Logs</pd:to>
        <pd:xpathDescription>No Update, ERR_MSG Exist in DB</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>substring($Start/DataInput/pfx2:ReuterRecord/pfx2:Err_Msg,1, 12) =  "[ProcessErr]"
and $FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/successIndicator !="Success"
and not(contains($FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/messages[1] , "ALREADY EXIST"  ))
and not(contains($FXSpotdealInput/outputMessage/pfx4:FXSpotdealInputResponse/Status/messages[1] , "ALREADY ASSIGNED"  ))</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>No Write Logs</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>LogEnd</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>LogEnd</pd:from>
        <pd:to>Navigate End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-6697729</pd:lineColor>
        <pd:conditionType>error</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Navigate End</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-6697729</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Spot-Internal</pd:from>
        <pd:to>WSError-1</pd:to>
        <pd:xpathDescription>Error, No Response</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>error</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>T24Response-Internal</pd:from>
        <pd:to>0.Update-SM-Internal</pd:to>
        <pd:xpathDescription>0.Success</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Spot-Internal/outputMessage/pfx4:FXSpotdealInternalInputResponse/Status/successIndicator = 'Success'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>T24Response-Internal</pd:from>
        <pd:to>2.Update SM - Other Res-Internal</pd:to>
        <pd:xpathDescription>2.OtherRes</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>WSError-1</pd:from>
        <pd:to>3.Update SM - Timeout - Internal</pd:to>
        <pd:xpathDescription>3.Timeout</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$_error/ns2:ErrorReport/MsgCode = 'BWENGINE-100029'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>WSError-1</pd:from>
        <pd:to>4.Update SM - Other Error - Internal</pd:to>
        <pd:xpathDescription>4.OtherErr</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>0.Update-SM-Internal</pd:from>
        <pd:to>NavigateOnly</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>2.Update SM - Other Res-Internal</pd:from>
        <pd:to>NavigateOnly</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>3.Update SM - Timeout - Internal</pd:from>
        <pd:to>NavigateOnly</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>4.Update SM - Other Error - Internal</pd:from>
        <pd:to>NavigateOnly</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Navigate</pd:from>
        <pd:to>Map To T24 Model - Spot</pd:to>
        <pd:xpathDescription>Is Spot External</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>($Start/DataInput/pfx2:ReuterRecord/pfx2:Currency1 !='VND')
and
($Start/DataInput/pfx2:ReuterRecord/pfx2:Currency2 !='VND')</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Navigate</pd:from>
        <pd:to>Map To T24 Model - Spot Internal</pd:to>
        <pd:xpathDescription>Is Spot Internal</pd:xpathDescription>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>($Start/DataInput/pfx2:ReuterRecord/pfx2:Currency1 = 'VND')
or
($Start/DataInput/pfx2:ReuterRecord/pfx2:Currency2 = 'VND')</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Update GW</pd:from>
        <pd:to>go to End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-6697729</pd:lineColor>
        <pd:conditionType>error</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>go to End</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-6697729</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Catch Unexpected Exception</pd:from>
        <pd:to>99. Has Unexpected Exception</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-26215</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>99. Has Unexpected Exception</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-26215</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
</pd:ProcessDefinition>